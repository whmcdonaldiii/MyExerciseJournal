@using MyExerciseJournal.Models

<MudGrid>
    <MudItem xs="12">
        <MudSelect T="SessionType?" Label="Session Type" @bind-Value="@_selectedSessionType" >
            @foreach (SessionType sessionType in sessionTypes)
            {
                <MudSelectItem T="SessionType?" Value="@(sessionType)">@sessionType</MudSelectItem>
            }
        </MudSelect>
    </MudItem>
    <MudItem xs="12">
        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="SaveSession">Save</MudButton>
    </MudItem>
</MudGrid>

@code{
    [Parameter] public EventCallback<UserSession> OnSave { get; set; }

    private SessionType? _selectedSessionType;
    private List<SessionType> sessionTypes;

    protected override void OnInitialized()
    {
        sessionTypes = UserSession.GetSessionTypes();
        StateHasChanged();
    }

    private async Task SaveSession()
    {
        if(_selectedSessionType != null)
        {
            UserSession userSesh = new();
            userSesh.Date = DateTime.Now;
            userSesh.Exercises = new();
            userSesh.SessionTypeId = (int)_selectedSessionType;
            await OnSave.InvokeAsync(userSesh);
        }
    }
}